{% extends "layout.html" %}
{% block content %}
<div class="content-section">
	<h1>Dashboard</h1>
	<hr/>
	<a href="{{ url_for('create_session', scraper_name='TestScraper2') }}" class="btn btn-dark" role="button">start TestScraper2</a>
	<hr/>
	<h3>Active Sessions</h3>
	{% if active_sessions %}
		Currently running {{ number_of_active_sessions }} out of a maximum of {{ max_active_sessions }} concurrent sessions.
		<br>
		<a href="{{ url_for('dashboard') }}" class="btn btn-success" role="button">Refresh</a>
		<a href="{{ url_for('destroy_all_active_sessions') }}" class="btn btn-danger" role="button">End All</a>
		<br/>
		<table class="table">
		<thead>
			<tr>
			    <th scope="col">Session ID</th>
			    <th scope="col">Started</th>
			    <th scope="col">Scraper</th>
			    <th scope="col">Status</th>
			</tr>
		</thead>
		<tbody>
		{% for session in active_sessions %}
		<tr>
		    <th scope="row">{{ session.id }}</th>
		    <td>{{ session.date_started }}</td>
		    <td>{{ session.scraper }}</td>
		    <td>{{ session.status }}</td>
		    <td>
		    	<a href="{{ url_for('log', session_id=session.id) }}" class="btn btn-dark" role="button">Logs</a>
		  	</td>
		    <td>
		    	<a href="{{ url_for('destroy_session', session_id=session.id) }}" class="btn btn-danger" role="button">End</a>
		    </td>
		</tr>
		{% endfor %}
		</tbody>
		</table>
	{% else %}
		<div>There are no active sessions.</div>
	{% endif %}
	<hr/>
	<h3>Past Sessions</h3>
	{% if past_sessions %}
		<br/>
		<table class="table">
		<thead>
			<tr>
			    <th scope="col">Session ID</th>
			    <th scope="col">Stopped</th>
			    <th scope="col">Scraper</th>
			    <th scope="col">Status</th>
			    <th scope="col">Details</th>
			</tr>
		</thead>
		<tbody>
		{% for session in past_sessions %}
		<tr>
		    <th scope="row">{{ session.id }}</th>
		    <td>{{ session.date_stopped }}</td>
		    <td>{{ session.scraper }}</td>
		    <td>{{ session.status }}</td>
		    <td>
		    	<a href="{{ url_for('log', session_id=session.id) }}" class="btn btn-dark" role="button"><i class="fa fa-search"></i></a>
		    	<a href="{{ url_for('log', session_id=session.id) }}" class="btn btn-dark" role="button"><i class="fa fa-file-download"></i></a>
		    	<a href="{{ url_for('log', session_id=session.id) }}" class="btn btn-danger" role="button"><i class="glyphicon glyphicon-asterisk"></i></a>
		  	</td>
		</tr>
		{% endfor %}
		</tbody>
		</table>
	{% else %}
		<div>There are no active sessions.</div>
	{% endif %}
</div>
{% endblock %}